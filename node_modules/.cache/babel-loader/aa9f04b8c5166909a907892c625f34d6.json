{"ast":null,"code":"import _regeneratorRuntime from\"/Users/matveystepanov/Documents/Rick-Morty/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"/Users/matveystepanov/Documents/Rick-Morty/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _objectSpread from\"/Users/matveystepanov/Documents/Rick-Morty/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import{mainAPI}from'../api/api';var SET_DATA='SET_DATA';var SET_INFO='SET_INFO';var SET_CURRENT_PAGE='SET_CURRENT_PAGE';var SET_CHARACTER='SET_CHARACTER';var SET_EPISODES='SET_EPISODES';var TOGGLE_IS_FETCHING='TOGGLE_IS_FETCHING';var initialState={data:[],info:{},currentPage:1,character:{},episodes:[],isFetching:false};export var mainReducer=function mainReducer(){var state=arguments.length>0&&arguments[0]!==undefined?arguments[0]:initialState;var action=arguments.length>1?arguments[1]:undefined;switch(action.type){case SET_DATA:return _objectSpread(_objectSpread({},state),{},{data:action.data});case SET_INFO:return _objectSpread(_objectSpread({},state),{},{info:action.info});case SET_CHARACTER:return _objectSpread(_objectSpread({},state),{},{character:action.character});case SET_EPISODES:return _objectSpread(_objectSpread({},state),{},{episodes:action.episodes});case TOGGLE_IS_FETCHING:return _objectSpread(_objectSpread({},state),{},{isFetching:action.isFetching});case SET_CURRENT_PAGE:return _objectSpread(_objectSpread({},state),{},{currentPage:action.currentPage});default:return state;}};var setData=function setData(data){return{type:SET_DATA,data:data};};var setInfo=function setInfo(info){return{type:SET_INFO,info:info};};var toggleIsFetching=function toggleIsFetching(isFetching){return{type:TOGGLE_IS_FETCHING,isFetching:isFetching};};var setCharacter=function setCharacter(character){return{type:SET_CHARACTER,character:character};};var setEpisodes=function setEpisodes(episodes){return{type:SET_EPISODES,episodes:episodes};};var setCurrentPage=function setCurrentPage(currentPage){return{type:SET_CURRENT_PAGE,currentPage:currentPage};};export var requestData=function requestData(page){return/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(dispatch){var response;return _regeneratorRuntime().wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:dispatch(toggleIsFetching(true));_context.next=3;return mainAPI.getData(page);case 3:response=_context.sent;if(response.status===200){dispatch(setData(response.data.results));dispatch(setInfo(response.data.info));dispatch(toggleIsFetching(false));}else{console.log(response);dispatch(toggleIsFetching(false));}case 5:case\"end\":return _context.stop();}}},_callee);}));return function(_x){return _ref.apply(this,arguments);};}();};export var requestCharacter=function requestCharacter(id){return/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee3(dispatch){var response,allEpisodes,responseEpisodes,dataArr;return _regeneratorRuntime().wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:dispatch(toggleIsFetching(true));_context3.next=3;return mainAPI.getCharacter(id);case 3:response=_context3.sent;if(!(response.status===200)){_context3.next=24;break;}dispatch(setCharacter(response.data));allEpisodes=[];response.data.episode.forEach(function(el){var id=el.split('/').pop();allEpisodes.push(id);});_context3.next=10;return mainAPI.getEpisodes(allEpisodes);case 10:responseEpisodes=_context3.sent;if(!(responseEpisodes.status===200)){_context3.next=20;break;}dataArr=[].concat(responseEpisodes.data);_context3.next=15;return Promise.all(dataArr.map(/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee2(ep){var queryString,result;return _regeneratorRuntime().wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:queryString=ep.characters[ep.characters.length-1].split('/').pop()+','+ep.characters[ep.characters.length-2].split('/').pop();_context2.next=3;return mainAPI.getCharacter(queryString);case 3:result=_context2.sent;return _context2.abrupt(\"return\",_objectSpread(_objectSpread({},ep),{},{charactersImages:[result.data[0].image,result.data[1].image]}));case 5:case\"end\":return _context2.stop();}}},_callee2);}));return function(_x3){return _ref3.apply(this,arguments);};}()));case 15:dataArr=_context3.sent;dispatch(setEpisodes(dataArr));dispatch(toggleIsFetching(false));_context3.next=21;break;case 20:console.log(responseEpisodes);case 21:dispatch(toggleIsFetching(false));_context3.next=26;break;case 24:console.log(response);dispatch(toggleIsFetching(false));case 26:case\"end\":return _context3.stop();}}},_callee3);}));return function(_x2){return _ref2.apply(this,arguments);};}();};export var changePage=function changePage(page){return/*#__PURE__*/function(){var _ref4=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee4(dispatch){return _regeneratorRuntime().wrap(function _callee4$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:return _context4.abrupt(\"return\",dispatch(setCurrentPage(page)));case 1:case\"end\":return _context4.stop();}}},_callee4);}));return function(_x4){return _ref4.apply(this,arguments);};}();};","map":{"version":3,"names":["mainAPI","SET_DATA","SET_INFO","SET_CURRENT_PAGE","SET_CHARACTER","SET_EPISODES","TOGGLE_IS_FETCHING","initialState","data","info","currentPage","character","episodes","isFetching","mainReducer","state","action","type","setData","setInfo","toggleIsFetching","setCharacter","setEpisodes","setCurrentPage","requestData","page","dispatch","getData","response","status","results","console","log","requestCharacter","id","getCharacter","allEpisodes","episode","forEach","el","split","pop","push","getEpisodes","responseEpisodes","dataArr","concat","Promise","all","map","ep","queryString","characters","length","result","charactersImages","image","changePage"],"sources":["/Users/matveystepanov/Documents/Rick-Morty/src/redux/main-reducer.js"],"sourcesContent":["import { mainAPI } from '../api/api';\n\nconst SET_DATA = 'SET_DATA'\nconst SET_INFO = 'SET_INFO'\nconst SET_CURRENT_PAGE = 'SET_CURRENT_PAGE'\nconst SET_CHARACTER = 'SET_CHARACTER'\nconst SET_EPISODES = 'SET_EPISODES'\nconst TOGGLE_IS_FETCHING = 'TOGGLE_IS_FETCHING'\n\nconst initialState = {\n    data: [],\n    info: {},\n    currentPage: 1,\n    character: {},\n    episodes: [],\n    isFetching: false\n}\n\nexport const mainReducer = (state = initialState, action) => {\n    switch (action.type){\n        case SET_DATA: \n            return {...state, data: action.data}\n        case SET_INFO: \n            return {...state, info: action.info}\n        case SET_CHARACTER: \n            return {...state, character: action.character}\n        case SET_EPISODES: \n            return {...state, episodes: action.episodes}\n        case TOGGLE_IS_FETCHING: \n            return {...state, isFetching: action.isFetching}\n        case SET_CURRENT_PAGE: \n            return {...state, currentPage: action.currentPage}\n        default: \n            return state\n    }\n}\n\nconst setData = (data) => ({type: SET_DATA, data})\nconst setInfo = (info) => ({type: SET_INFO, info})\nconst toggleIsFetching = (isFetching) => ({type: TOGGLE_IS_FETCHING, isFetching})\nconst setCharacter = (character) => ({type: SET_CHARACTER, character})\nconst setEpisodes = (episodes) => ({type: SET_EPISODES, episodes})\nconst setCurrentPage = (currentPage) => ({type: SET_CURRENT_PAGE, currentPage})\n\nexport const requestData = (page) => async (dispatch) => {\n    dispatch(toggleIsFetching(true))\n    const response = await mainAPI.getData(page)\n    if(response.status === 200){\n        dispatch(setData(response.data.results))\n        dispatch(setInfo(response.data.info))\n        dispatch(toggleIsFetching(false))\n    }else{\n        console.log(response);\n        dispatch(toggleIsFetching(false))\n    }\n}\n\nexport const requestCharacter = (id) => async (dispatch) => {\n    dispatch(toggleIsFetching(true))\n    const response = await mainAPI.getCharacter(id)\n    if(response.status === 200){\n        dispatch(setCharacter(response.data))\n\n        let allEpisodes = []\n\n        response.data.episode.forEach(el => {\n            const id = el.split('/').pop()\n            allEpisodes.push(id)\n        })\n\n        const responseEpisodes = await mainAPI.getEpisodes(allEpisodes)\n        if(responseEpisodes.status === 200){\n            let dataArr = [].concat(responseEpisodes.data)\n\n            dataArr = await Promise.all(dataArr.map(async (ep) => {\n                let queryString = ep.characters[ep.characters.length - 1].split('/').pop() + ',' + ep.characters[ep.characters.length - 2].split('/').pop()\n                let result = await mainAPI.getCharacter(queryString)\n                return {...ep, charactersImages: [\n                    result.data[0].image, \n                    result.data[1].image\n                ]}\n            }))\n            dispatch(setEpisodes(dataArr))\n            dispatch(toggleIsFetching(false))\n        }else console.log(responseEpisodes)\n        dispatch(toggleIsFetching(false))\n    }else{\n        console.log(response);\n        dispatch(toggleIsFetching(false))\n    }\n}\n\n\nexport const changePage = (page) => async (dispatch) => dispatch(setCurrentPage(page))"],"mappings":"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"},"metadata":{},"sourceType":"module"}